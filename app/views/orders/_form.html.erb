<%= form_for(@order) do |f| %>
  <% if @order.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@order.errors.count, "error") %> prohibited this order from being saved:</h2>

      <ul>
      <% @order.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div style="width:360px;margin-bottom: 30px;background: #fff;padding: 30px;margin-right:30px;">

    <p style="font-size: 16px;color: #333;height: 20px;font-weight:500;margin-bottom:30px;">Contact & Shipping</p>


    <%= f.hidden_field :user_id, value: current_user.id %>


    <div style="font-size:13px;font-weight:bold;">
      Shipping Address
    </div>

    <div class="layout vertical">
      <% current_user.addresses.each do |address| %>
        <div class="horizontal layout center">
          <%= f.radio_button(:address_id, address.id) %>
          <div class="layout vertical" style="margin-left:10px;">
            <div style="font-size:12px;font-weight:bold;margin-top:8px;"><%= address.name %></div>
            <div style="font-size:12px;">
              <%= address.street_address1 %><br>
              <%= address.street_address2 %><br>
              <%= address.city + "," + address.state + " " + address.zipcode %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <%= f.hidden_field :stripe_card_token %>
  </div>

  <div style="width:360px;margin-bottom: 30px;background: #fff;padding: 30px;margin-right:30px;">
    <div class="layout horizontal">
      <p style="font-size: 16px;color: #333;height: 20px;font-weight:500;margin-bottom:30px;">Billing</p>
      <div class="flex"></div>
      <div class="layout horizontal center">
        <%= image_tag "https://static.squarespace.com/universal/images-v6/checkout/discover.png", style: "height:27px;margin-right:4px;" %>
        <%= image_tag "https://static.squarespace.com/universal/images-v6/checkout/mastercard.png", style: "height:27px;margin-right:4px;" %>
        <%= image_tag "https://static.squarespace.com/universal/images-v6/checkout/visa.png", style: "height:27px;margin-right:4px;" %>
        <%= image_tag "https://static.squarespace.com/universal/images-v6/checkout/americanexpress.png", style: "height:27px;" %>
      </div>
    </div>

    <% if @order.stripe_card_token %>
      Credit card has already been provided
    <% else %>
      <%= text_field_tag :card_number, nil, name: nil, placeholder: "Credit Card Number" %>

      <%= text_field_tag :card_code, nil, name: nil, placeholder: "Security Code on Card (CVV)" %>

      <input type="text" id="card_code" value="Card Expiration:" disabled style="border:none;width:34%;float:left;padding-left:5px;">

      <div id="state-container" style="width:38%;">
        <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month", style: "height:34px;"} %>
      </div>

      <div id="state-container" style="margin-right:0;margin-left:2%;">
        <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year", style: "height:34px;"} %>
      </div>
    <% end %>

    <div id="stripe_error">
      <noscript>JavaScript is not enabled and is required for this form. First enable it in your web browser settings.</noscript>
    </div>
    <br>
    <%= f.submit "Continue", id: "submit-order", class: "layout horizontal center-justified" %>

  </div>
<% end %>
